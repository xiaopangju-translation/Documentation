(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{915:function(a,t,v){"use strict";v.r(t);var _=v(41),s=Object(_.a)({},(function(){var a=this,t=a.$createElement,v=a._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[v("h1",{attrs:{id:"inpageedit-开发指南"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#inpageedit-开发指南"}},[a._v("#")]),a._v(" InPageEdit 开发指南")]),a._v(" "),v("h2",{attrs:{id:"版本命名方针"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#版本命名方针"}},[a._v("#")]),a._v(" 版本命名方针")]),a._v(" "),v("p",[a._v("版本号的格式为 "),v("code",[a._v("X.Y.Z")]),a._v(" (又称"),v("code",[a._v("Major.Minor.Patch")]),a._v(")，递增的规则为：")]),a._v(" "),v("ul",[v("li",[v("code",[a._v("X")]),a._v(" 表示主版本号，当 API 的兼容性变化时，X 需递增。")]),a._v(" "),v("li",[v("code",[a._v("Y")]),a._v(" 表示次版本号，当增加功能时(不影响 API 的兼容性)，Y 需递增。")]),a._v(" "),v("li",[v("code",[a._v("Z")]),a._v(" 表示修订号，当做 Bug 修复时(不影响 API 的兼容性)，Z 需递增。")])]),a._v(" "),v("p",[a._v("详细的规则如下：")]),a._v(" "),v("ul",[v("li",[a._v("X, Y, Z 必须为"),v("strong",[a._v("非负整数")]),a._v("，且"),v("strong",[a._v("不得")]),a._v("包含前导零，必须按数值"),v("strong",[a._v("递增")]),a._v("，如 1.9.0 -> 1.10.0 -> 1.11.0")]),a._v(" "),v("li",[a._v("当 API 的兼容性变化时，X 必须递增，Y 和 Z 同时设置为 0")]),a._v(" "),v("li",[a._v("当新增功能(不影响 API 的兼容性)或者 API 被标记为 Deprecated 时，Y 必须递增，同时 Z 设置为 0")]),a._v(" "),v("li",[a._v("当进行 bug fix 时，Z 必须递增")]),a._v(" "),v("li",[a._v("先行版本号(Pre-release)意味该版本不稳定，可能存在兼容性问题，其格式为：X.Y.Z-[类型].[非负整数]，例如"),v("code",[a._v("2.0.0-alpha.1")])]),a._v(" "),v("li",[a._v("版本号的排序规则为依次比较主版本号、次版本号和修订号的数值，如 1.0.0 < 1.0.1 < 1.1.1 < 2.0.0；对于先行版本号和开发版本号，我们规定 alpha < beta < pre < stable")]),a._v(" "),v("li",[v("strong",[a._v("注意")]),a._v("：版本一经发布，不得修改其内容，任何修改必须在新版本发布！")])]),a._v(" "),v("p",[a._v("先行版本的类型如下：")]),a._v(" "),v("ul",[v("li",[a._v("内部测试："),v("code",[a._v("alpha")])]),a._v(" "),v("li",[a._v("外部测试："),v("code",[a._v("beta")])]),a._v(" "),v("li",[a._v("预发布版："),v("code",[a._v("pre")])])]),a._v(" "),v("p",[a._v("使用以下命令维护版本号：")]),a._v(" "),v("div",{staticClass:"language-bash extra-class"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[v("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 检查版本号")]),a._v("\n"),v("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" checkversion\n"),v("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 跟新版本号")]),a._v("\n"),v("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" updateversion x.x.x-xxx.x\n")])])]),v("h2",{attrs:{id:"标签（tag）方针"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#标签（tag）方针"}},[a._v("#")]),a._v(" 标签（tag）方针")]),a._v(" "),v("ul",[v("li",[a._v("最新稳定版："),v("code",[a._v("latest")])]),a._v(" "),v("li",[a._v("最新测试版："),v("code",[a._v("canary")])])]),a._v(" "),v("h2",{attrs:{id:"代码格式方针"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#代码格式方针"}},[a._v("#")]),a._v(" 代码格式方针")]),a._v(" "),v("p",[a._v("本项目使用"),v("code",[a._v("prettier")]),a._v("规范代码格式，在编撰完毕后，请使用"),v("code",[a._v("prettier --check <file>")]),a._v("检查格式是否符合标准，也可以使用"),v("code",[a._v("yarn prettier")]),a._v("直接格式化全部文件。")]),a._v(" "),v("p",[a._v("本项目的格式规范如下：")]),a._v(" "),v("ul",[v("li",[a._v("请使用空格缩进，缩进为 2 空格")]),a._v(" "),v("li",[a._v("请使用单引号或模板语法包裹字符串")]),a._v(" "),v("li",[a._v("请不要在行末添加分号")]),a._v(" "),v("li",[a._v("关键词与关键词之间需要使用空格隔开，例如"),v("code",[a._v("{ foo: 'bar' }")])]),a._v(" "),v("li",[a._v("任何进入 P4 阶段的语法都是允许的，我们不考虑低版本浏览器兼容")])]),a._v(" "),v("p",[a._v("您可以在"),v("code",[a._v(".prettierrc.js")]),a._v("中找到相关配置，请不要更改此文件。")]),a._v(" "),v("h2",{attrs:{id:"开发指引"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#开发指引"}},[a._v("#")]),a._v(" 开发指引")]),a._v(" "),v("h3",{attrs:{id:"克隆仓库"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#克隆仓库"}},[a._v("#")]),a._v(" 克隆仓库")]),a._v(" "),v("p",[v("code",[a._v("git clone <url>")])]),a._v(" "),v("h3",{attrs:{id:"同步仓库"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#同步仓库"}},[a._v("#")]),a._v(" 同步仓库")]),a._v(" "),v("p",[a._v("每次开发前从远程仓库同步是一个好习惯。")]),a._v(" "),v("p",[v("code",[a._v("git pull")])]),a._v(" "),v("h3",{attrs:{id:"安装依赖"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[a._v("#")]),a._v(" 安装依赖")]),a._v(" "),v("infobox",[a._v("\n本项目使用"),v("strong",[a._v("yarn")]),a._v("管理包依赖，如果您没有安装yarn，请使用"),v("code",[a._v("npm i -g yarn")]),a._v("安装\n")]),a._v(" "),v("p",[v("code",[a._v("yarn install")])]),a._v(" "),v("h3",{attrs:{id:"测试"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[a._v("#")]),a._v(" 测试")]),a._v(" "),v("p",[a._v("当阶段性开发完毕，需要使用工具测试项目，本项目使用"),v("code",[a._v("eslint")]),a._v("进行测试。")]),a._v(" "),v("p",[v("code",[a._v("yarn test")])]),a._v(" "),v("h3",{attrs:{id:"构建"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#构建"}},[a._v("#")]),a._v(" 构建")]),a._v(" "),v("p",[a._v("本项目通过"),v("code",[a._v("webpack")]),a._v("打包构建，输出文件位于"),v("code",[a._v("dist")]),a._v("文件夹")]),a._v(" "),v("ul",[v("li",[a._v("UNIX 系统(bash)："),v("code",[a._v("yarn build:linux")])]),a._v(" "),v("li",[a._v("Windows 系统(cmd/powershell)："),v("code",[a._v("yarn build:windows")])])]),a._v(" "),v("h2",{attrs:{id:"通过-node-js-package-发布"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#通过-node-js-package-发布"}},[a._v("#")]),a._v(" 通过 Node.js Package 发布")]),a._v(" "),v("infobox",[a._v("\n本项目的 GitHub 的 master 分支收到推送时，会自动构建发布npm包\n")]),a._v(" "),v("infobox",{attrs:{type:"warning"}},[a._v("\n在手动推送前请记得先进行构建\n")]),a._v(" "),v("h3",{attrs:{id:"推送"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#推送"}},[a._v("#")]),a._v(" 推送")]),a._v(" "),v("p",[a._v("当测试通过，可以选择发布包。可以试用一下指令推送包：")]),a._v(" "),v("ul",[v("li",[a._v("推送稳定版："),v("code",[a._v("npm run publish:stable")])]),a._v(" "),v("li",[a._v("推送测试版："),v("code",[a._v("npm run publish:canary")])])]),a._v(" "),v("p",[a._v("注：推送测试版包的指令目前针对 Windows 系统设计；稳定版一般由 GitHub Actions 自动构建，一般情况下开发完毕后向源仓库发送 PR 即可。")]),a._v(" "),v("h3",{attrs:{id:"撤回版本"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#撤回版本"}},[a._v("#")]),a._v(" 撤回版本")]),a._v(" "),v("p",[a._v("有时候错误的推送了未完成的代码，这时候需要撤回发布。")]),a._v(" "),v("div",{staticClass:"language-bash extra-class"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[v("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" unpublish "),v("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mediawiki-inpageedit@<version>"')]),a._v("\n")])])]),v("h3",{attrs:{id:"移动-tag"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#移动-tag"}},[a._v("#")]),a._v(" 移动 tag")]),a._v(" "),v("p",[a._v("有时候会将测试版错误标记为稳定版发布，这时候需要将"),v("code",[a._v("latest")]),a._v("标记重新指向稳定版。")]),a._v(" "),v("div",{staticClass:"language-bash extra-class"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[v("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看所有 tag")]),a._v("\n"),v("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" dist-tag\n"),v("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 移动 tag")]),a._v("\n"),v("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" dist-tag "),v("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" "),v("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mediawiki-inpageedit@<version>"')]),a._v(" "),v("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("tag"),v("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])])],1)}),[],!1,null,null,null);t.default=s.exports}}]);